early_decade_monthly_mn$month <- rep(c(10:12,1:9), times=10)
early_decade_mon_mn <- aggregate(ConcDay ~ month, data = early_decade_monthly_mn, 'mean')
early_decade_mon_sd <- aggregate(ConcDay ~ month, data = early_decade_monthly_mn, 'sd')
early_decade_mon_mn <- early_decade_mon_mn[c(10:12,1:9),]
early_decade_mon_sd <- early_decade_mon_sd[c(10:12,1:9),]
recent_decade_monthly_mn$month <- rep(c(10:12,1:9), times=10)
recent_decade_mon_mn <- aggregate(ConcDay ~ month, data = recent_decade_monthly_mn, 'mean')
recent_decade_mon_sd <- aggregate(ConcDay ~ month, data = recent_decade_monthly_mn, 'sd')
recent_decade_mon_mn <- recent_decade_mon_mn[c(10:12,1:9),]
recent_decade_mon_sd <- recent_decade_mon_sd[c(10:12,1:9),]
mdat2 <- matrix(c(early_decade_mon_mn$ConcDay, recent_decade_mon_mn$ConcDay),
nrow=2,ncol = 12, byrow=TRUE,
dimnames = list(c("1972-1982", "2009-2019"),
c(format(seq(as.Date('1973-10-01'), as.Date('1974-09-01'), by='month'), '%b'))))
# Be sure to adjust the legend's first decade start and stop year correctly
mx <- max(c((early_decade_mon_mn$ConcDay + early_decade_mon_sd$ConcDay), (recent_decade_mon_mn$ConcDay + recent_decade_mon_sd$ConcDay)))
tiff("timing_shift_in_TP_conc_monthly_means.tif", height=800, width=900, res=130)
par(mar=c(3,5,2,1))
x <- barplot(mdat2, beside=TRUE, las=1, ylim=c(0,mx), col = c("lightblue", "mistyrose"))
abline(h=0)
arrows(x0=x[1,], y0=early_decade_mon_mn$ConcDay - early_decade_mon_sd$ConcDay, x1=x[1,], y1=early_decade_mon_mn$ConcDay + early_decade_mon_sd$ConcDay, angle=90, length=0.04, code=3)
arrows(x0=x[2,], y0=recent_decade_mon_mn$ConcDay - recent_decade_mon_sd$ConcDay, x1=x[2,], y1=recent_decade_mon_mn$ConcDay + recent_decade_mon_sd$ConcDay, angle=90, length=0.04, code=3)
mtext(side=2, expression(paste(TP,', mg ',L^-1,sep='')), line=3)
legend(x=25, y=0.9 * mx, c("1990-2000", "2001-2011"), pch=c(22,22), pt.cex=2, pt.bg=c("lightblue", "mistyrose"), bty='n', xpd=TRUE)
dev.off()
tiff("timing_shift_in_TP_conc_monthly_means.tif", height=800, width=900, res=130)
par(mar=c(3,5,2,1))
x <- barplot(mdat2, beside=TRUE, las=1, ylim=c(0,mx), col = c("lightblue", "mistyrose"))
abline(h=0)
arrows(x0=x[1,], y0=early_decade_mon_mn$ConcDay - early_decade_mon_sd$ConcDay, x1=x[1,], y1=early_decade_mon_mn$ConcDay + early_decade_mon_sd$ConcDay, angle=90, length=0.04, code=3)
arrows(x0=x[2,], y0=recent_decade_mon_mn$ConcDay - recent_decade_mon_sd$ConcDay, x1=x[2,], y1=recent_decade_mon_mn$ConcDay + recent_decade_mon_sd$ConcDay, angle=90, length=0.04, code=3)
mtext(side=2, expression(paste(TP,', mg ',L^-1,sep='')), line=3)
legend(x=25, y=0.9 * mx, c("1972-1982", "2009-2019"), pch=c(22,22), pt.cex=2, pt.bg=c("lightblue", "mistyrose"), bty='n', xpd=TRUE)
dev.off()
# --------------------------------------------------------------------------------------------------------
# The following script is for a non-standard EGRET plot and instead help generate a plot Michael requested
localDaily <- getDaily(eList)
# Will need to adjust the date range below based on each gages unique start/stop dates
early_decade <- subset(localDaily, localDaily$Date > as.Date('1971-10-01') & localDaily$Date < as.Date('1981-10-01'))
recent_decade <- subset(localDaily, localDaily$Date > as.Date('2009-07-01'))
early_decade_monthly_mn <- aggregate(ConcDay ~ MonthSeq, data = early_decade, 'mean')
recent_decade_monthly_mn <- aggregate(ConcDay ~ MonthSeq, data = recent_decade, 'mean')
# early_decade_monthly_mn$month <- format(seq(as.Date('1972-10-01'), as.Date('1982-09-30'), by='month'), '%b')
early_decade_monthly_mn$month <- rep(c(10:12,1:9), times=10)
early_decade_mon_mn <- aggregate(ConcDay ~ month, data = early_decade_monthly_mn, 'mean')
early_decade_mon_sd <- aggregate(ConcDay ~ month, data = early_decade_monthly_mn, 'sd')
early_decade_mon_mn <- early_decade_mon_mn[c(10:12,1:9),]
early_decade_mon_sd <- early_decade_mon_sd[c(10:12,1:9),]
recent_decade_monthly_mn$month <- rep(c(10:12,1:9), times=10)
recent_decade_mon_mn <- aggregate(ConcDay ~ month, data = recent_decade_monthly_mn, 'mean')
recent_decade_mon_sd <- aggregate(ConcDay ~ month, data = recent_decade_monthly_mn, 'sd')
recent_decade_mon_mn <- recent_decade_mon_mn[c(10:12,1:9),]
recent_decade_mon_sd <- recent_decade_mon_sd[c(10:12,1:9),]
mdat2 <- matrix(c(early_decade_mon_mn$ConcDay, recent_decade_mon_mn$ConcDay),
nrow=2,ncol = 12, byrow=TRUE,
dimnames = list(c("1972-1982", "2009-2019"),
c(format(seq(as.Date('1973-10-01'), as.Date('1974-09-01'), by='month'), '%b'))))
# Be sure to adjust the legend's first decade start and stop year correctly
mx <- max(c((early_decade_mon_mn$ConcDay + early_decade_mon_sd$ConcDay), (recent_decade_mon_mn$ConcDay + recent_decade_mon_sd$ConcDay)))
tiff("timing_shift_in_TP_conc_monthly_means.tif", height=800, width=900, res=130)
par(mar=c(3,5,2,1))
x <- barplot(mdat2, beside=TRUE, las=1, ylim=c(0,mx), col = c("lightblue", "mistyrose"))
abline(h=0)
arrows(x0=x[1,], y0=early_decade_mon_mn$ConcDay - early_decade_mon_sd$ConcDay, x1=x[1,], y1=early_decade_mon_mn$ConcDay + early_decade_mon_sd$ConcDay, angle=90, length=0.04, code=3)
arrows(x0=x[2,], y0=recent_decade_mon_mn$ConcDay - recent_decade_mon_sd$ConcDay, x1=x[2,], y1=recent_decade_mon_mn$ConcDay + recent_decade_mon_sd$ConcDay, angle=90, length=0.04, code=3)
mtext(side=2, expression(paste(TP,', mg ',L^-1,sep='')), line=3)
legend(x=25, y=0.9 * mx, c("1972-1982", "2009-2019"), pch=c(22,22), pt.cex=2, pt.bg=c("lightblue", "mistyrose"), bty='n', xpd=TRUE)
dev.off()
# Now attempting a Wilcox Test (aka Mann-Whitney-Wilcoxon Rank Sum test)
# ----------------------------------------------------------------------
early_jan <- subset(early_decade_monthly_mn, month==1)
recent_jan <- subset(recent_decade_monthly_mn, month==1)
SanJVernalis_TP_conc_jan_wilcox <- wilcox.test(recent_jan$ConcDay, early_jan$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_feb <- subset(early_decade_monthly_mn, month==2)
recent_feb <- subset(recent_decade_monthly_mn, month==2)
SanJVernalis_TP_conc_feb_wilcox <- wilcox.test(recent_feb$ConcDay, early_feb$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_mar <- subset(early_decade_monthly_mn, month==3)
recent_mar <- subset(recent_decade_monthly_mn, month==3)
SanJVernalis_TP_conc_mar_wilcox <- wilcox.test(recent_mar$ConcDay, early_mar$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_apr <- subset(early_decade_monthly_mn, month==4)
recent_apr <- subset(recent_decade_monthly_mn, month==4)
v_TP_conc_apr_wilcox <- wilcox.test(recent_apr$ConcDay, early_apr$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_may <- subset(early_decade_monthly_mn, month==5)
recent_may <- subset(recent_decade_monthly_mn, month==5)
SanJVernalis_TP_conc_may_wilcox <- wilcox.test(recent_may$ConcDay, early_may$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_jun <- subset(early_decade_monthly_mn, month==6)
recent_jun <- subset(recent_decade_monthly_mn, month==6)
SanJVernalis_TP_conc_jun_wilcox <- wilcox.test(recent_jun$ConcDay, early_jun$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_jul <- subset(early_decade_monthly_mn, month==7)
recent_jul <- subset(recent_decade_monthly_mn, month==7)
SanJVernalis_TP_conc_jul_wilcox <- wilcox.test(recent_jul$ConcDay, early_jul$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_aug <- subset(early_decade_monthly_mn, month==8)
recent_aug <- subset(recent_decade_monthly_mn, month==8)
SanJVernalis_TP_conc_aug_wilcox <- wilcox.test(recent_aug$ConcDay, early_aug$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_sep <- subset(early_decade_monthly_mn, month==9)
recent_sep <- subset(recent_decade_monthly_mn, month==9)
SanJVernalis_TP_conc_sep_wilcox <- wilcox.test(recent_sep$ConcDay, early_sep$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_oct <- subset(early_decade_monthly_mn, month==10)
recent_oct <- subset(recent_decade_monthly_mn, month==10)
SanJVernalis_TP_conc_oct_wilcox <- wilcox.test(recent_oct$ConcDay, early_oct$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_nov <- subset(early_decade_monthly_mn, month==11)
recent_nov <- subset(recent_decade_monthly_mn, month==11)
SanJVernalis_TP_conc_nov_wilcox <- wilcox.test(recent_nov$ConcDay, early_nov$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_dec <- subset(early_decade_monthly_mn, month==12)
recent_dec <- subset(recent_decade_monthly_mn, month==12)
SanJVernalis_TP_conc_dec_wilcox <- wilcox.test(recent_dec$ConcDay, early_dec$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
Conc_compare <- data.frame(chng_est=c(SanJVernalis_TP_conc_oct_wilcox$est,
SanJVernalis_TP_conc_nov_wilcox$est,
SanJVernalis_TP_conc_dec_wilcox$est,
SanJVernalis_TP_conc_jan_wilcox$est,
SanJVernalis_TP_conc_feb_wilcox$est,
SanJVernalis_TP_conc_mar_wilcox$est,
SanJVernalis_TP_conc_apr_wilcox$est,
SanJVernalis_TP_conc_may_wilcox$est,
SanJVernalis_TP_conc_jun_wilcox$est,
SanJVernalis_TP_conc_jul_wilcox$est,
SanJVernalis_TP_conc_aug_wilcox$est,
SanJVernalis_TP_conc_sep_wilcox$est),
low_conf=c(SanJVernalis_TP_conc_oct_wilcox$conf.int[1],
SanJVernalis_TP_conc_nov_wilcox$conf.int[1],
SanJVernalis_TP_conc_dec_wilcox$conf.int[1],
SanJVernalis_TP_conc_jan_wilcox$conf.int[1],
SanJVernalis_TP_conc_feb_wilcox$conf.int[1],
SanJVernalis_TP_conc_mar_wilcox$conf.int[1],
SanJVernalis_TP_conc_apr_wilcox$conf.int[1],
SanJVernalis_TP_conc_may_wilcox$conf.int[1],
SanJVernalis_TP_conc_jun_wilcox$conf.int[1],
SanJVernalis_TP_conc_jul_wilcox$conf.int[1],
SanJVernalis_TP_conc_aug_wilcox$conf.int[1],
SanJVernalis_TP_conc_sep_wilcox$conf.int[1]),
up_conf=c(SanJVernalis_TP_conc_oct_wilcox$conf.int[2],
SanJVernalis_TP_conc_nov_wilcox$conf.int[2],
SanJVernalis_TP_conc_dec_wilcox$conf.int[2],
SanJVernalis_TP_conc_jan_wilcox$conf.int[2],
SanJVernalis_TP_conc_feb_wilcox$conf.int[2],
SanJVernalis_TP_conc_mar_wilcox$conf.int[2],
SanJVernalis_TP_conc_apr_wilcox$conf.int[2],
SanJVernalis_TP_conc_may_wilcox$conf.int[2],
SanJVernalis_TP_conc_jun_wilcox$conf.int[2],
SanJVernalis_TP_conc_jul_wilcox$conf.int[2],
SanJVernalis_TP_conc_aug_wilcox$conf.int[2],
SanJVernalis_TP_conc_sep_wilcox$conf.int[2]))
write.table(Conc_compare, "SanJVernalis_TP_conc_wilcox.txt", quote=FALSE, row.names=FALSE)
rng <- max(abs(c(Conc_compare$up_conf, Conc_compare$low_conf)))
tiff("SanJVernalis_TP_conc_shift_wilcox_Vert_Bars.tif", height=600, width=800, res=130)
par(mar=c(4,5,0.5,0.5))
plot(seq(1:12), Conc_compare$chng_est, typ='h', lend=1, lwd=15, col='white', xaxt='n', xlim=c(1,13), ylim=c(-rng, rng), xlab="Month", ylab=expression(paste("Median Concentration Change, mg  ",L^-1,sep='')), las=1)
plotCI(seq(1:12), Conc_compare$chng_est, ui=Conc_compare$up_conf, li=Conc_compare$low_conf, pch=16, add=TRUE)
abline(h=0)
axis(side=1,at=seq(1,12,by=1), labels=format(c(seq(as.Date("2000-10-01"), as.Date("2000-12-01"), by="month"), seq(as.Date("2000-01-01"), as.Date("2000-09-01"), by="month")),'%b'), las=2)
legend('topright', c("Median difference", "90% Confidence Interval for the Median"), pch=c(16,NA), lwd=c(NA,1), pt.cex=c(1,NA), pt.bg=c('black',NA), bty='n', bg='white')
dev.off()
# Now do the load
# ---------------
early_decade_monthly_flx <- aggregate(FluxDay ~ MonthSeq, data = early_decade, 'sum')
recent_decade_monthly_flx <- aggregate(FluxDay ~ MonthSeq, data = recent_decade, 'sum')
# early_decade_monthly_mn$month <- format(seq(as.Date('1972-10-01'), as.Date('1982-09-30'), by='month'), '%b')
early_decade_monthly_flx$month <- rep(c(10:12,1:9), times=10)
early_decade_mon_mn_flx <- aggregate(FluxDay ~ month, data = early_decade_monthly_flx, 'mean')
early_decade_mon_sd_flx <- aggregate(FluxDay ~ month, data = early_decade_monthly_flx, 'sd')
early_decade_mon_mn_flx <- early_decade_mon_mn_flx[c(10:12,1:9),]
early_decade_mon_sd_flx <- early_decade_mon_sd_flx[c(10:12,1:9),]
recent_decade_monthly_flx$month <- rep(c(10:12,1:9), times=10)
recent_decade_mon_mn_flx <- aggregate(FluxDay ~ month, data = recent_decade_monthly_flx, 'mean')
recent_decade_mon_sd_flx <- aggregate(FluxDay ~ month, data = recent_decade_monthly_flx, 'sd')
recent_decade_mon_mn_flx <- recent_decade_mon_mn_flx[c(10:12,1:9),]
recent_decade_mon_sd_flx <- recent_decade_mon_sd_flx[c(10:12,1:9),]
mdat3 <- matrix(c(early_decade_mon_mn_flx$FluxDay, recent_decade_mon_mn_flx$FluxDay),
nrow=2,ncol = 12, byrow=TRUE,
dimnames = list(c("1990-2000", "2001-2011"),
c(format(seq(as.Date('1973-10-01'), as.Date('1974-09-01'), by='month'), '%b'))))
mx <- max(c((early_decade_mon_mn_flx$FluxDay + early_decade_mon_sd_flx$FluxDay), (recent_decade_mon_mn_flx$FluxDay + recent_decade_mon_sd_flx$FluxDay)))
tiff("timing_shift_in_TP_load_monthly_means.tif", height=800, width=900, res=130)
x <- barplot(mdat3, beside=TRUE, las=1, ylim=c(0,mx), col = c("lightblue", "mistyrose"))
abline(h=0)
arrows(x0=x[1,], y0=early_decade_mon_mn_flx$FluxDay - early_decade_mon_sd_flx$FluxDay, x1=x[1,], y1=early_decade_mon_mn_flx$FluxDay + early_decade_mon_sd_flx$FluxDay, angle=90, length=0.04, code=3)
arrows(x0=x[2,], y0=recent_decade_mon_mn_flx$FluxDay - recent_decade_mon_sd_flx$FluxDay, x1=x[2,], y1=recent_decade_mon_mn_flx$FluxDay + recent_decade_mon_sd_flx$FluxDay, angle=90, length=0.04, code=3)
mtext(side=2, expression(paste(TP,', kg ',month^-1,sep='')), line=2.5)
legend(x=30, y=0.9 * mx, c("1990-2000", "2001-2011"), pch=c(22,22), pt.cex=2, pt.bg=c("lightblue", "mistyrose"), bty='n', xpd=TRUE)
dev.off()
# Apply Wilcox.text to the monthly loads here...
early_jan_flx <- subset(early_decade_monthly_flx, month==1)
recent_jan_flx <- subset(recent_decade_monthly_flx, month==1)
SanJVernalis_TP_flux_jan_wilcox <- wilcox.test(recent_jan_flx$FluxDay, early_jan_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_feb_flx <- subset(early_decade_monthly_flx, month==2)
recent_feb_flx <- subset(recent_decade_monthly_flx, month==2)
SanJVernalis_TP_flux_feb_wilcox <- wilcox.test(recent_feb_flx$FluxDay, early_feb_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_mar_flx <- subset(early_decade_monthly_flx, month==3)
recent_mar_flx <- subset(recent_decade_monthly_flx, month==3)
SanJVernalis_TP_flux_mar_wilcox <- wilcox.test(recent_mar_flx$FluxDay, early_mar_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_apr_flx <- subset(early_decade_monthly_flx, month==4)
recent_apr_flx <- subset(recent_decade_monthly_flx, month==4)
SanJVernalis_TP_flux_apr_wilcox <- wilcox.test(recent_apr_flx$FluxDay, early_apr_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_may_flx <- subset(early_decade_monthly_flx, month==5)
recent_may_flx <- subset(recent_decade_monthly_flx, month==5)
SanJVernalis_TP_flux_may_wilcox <- wilcox.test(recent_may_flx$FluxDay, early_may_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_jun_flx <- subset(early_decade_monthly_flx, month==6)
recent_jun_flx <- subset(recent_decade_monthly_flx, month==6)
SanJVernalis_TP_flux_jun_wilcox <- wilcox.test(recent_jun_flx$FluxDay, early_jun_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_jul_flx <- subset(early_decade_monthly_flx, month==7)
recent_jul_flx <- subset(recent_decade_monthly_flx, month==7)
SanJVernalis_TP_flux_jul_wilcox <- wilcox.test(recent_jul_flx$FluxDay, early_jul_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_aug_flx <- subset(early_decade_monthly_flx, month==8)
recent_aug_flx <- subset(recent_decade_monthly_flx, month==8)
SanJVernalis_TP_flux_aug_wilcox <- wilcox.test(recent_aug_flx$FluxDay, early_aug_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_sep_flx <- subset(early_decade_monthly_flx, month==9)
recent_sep_flx <- subset(recent_decade_monthly_flx, month==9)
SanJVernalis_TP_flux_sep_wilcox <- wilcox.test(recent_sep_flx$FluxDay, early_sep_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_oct_flx <- subset(early_decade_monthly_flx, month==10)
recent_oct_flx <- subset(recent_decade_monthly_flx, month==10)
SanJVernalis_TP_flux_oct_wilcox <- wilcox.test(recent_oct_flx$FluxDay, early_oct_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_nov_flx <- subset(early_decade_monthly_flx, month==11)
recent_nov_flx <- subset(recent_decade_monthly_flx, month==11)
SanJVernalis_TP_flux_nov_wilcox <- wilcox.test(recent_nov_flx$FluxDay, early_nov_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_dec_flx <- subset(early_decade_monthly_flx, month==12)
recent_dec_flx <- subset(recent_decade_monthly_flx, month==12)
SanJVernalis_TP_flux_dec_wilcox <- wilcox.test(recent_dec_flx$FluxDay, early_dec_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
Flux_compare <- data.frame(chng_est=c(SanJVernalis_TP_flux_oct_wilcox$est,
SanJVernalis_TP_flux_nov_wilcox$est,
SanJVernalis_TP_flux_dec_wilcox$est,
SanJVernalis_TP_flux_jan_wilcox$est,
SanJVernalis_TP_flux_feb_wilcox$est,
SanJVernalis_TP_flux_mar_wilcox$est,
SanJVernalis_TP_flux_apr_wilcox$est,
SanJVernalis_TP_flux_may_wilcox$est,
SanJVernalis_TP_flux_jun_wilcox$est,
SanJVernalis_TP_flux_jul_wilcox$est,
SanJVernalis_TP_flux_aug_wilcox$est,
SanJVernalis_TP_flux_sep_wilcox$est),
low_conf=c(SanJVernalis_TP_flux_oct_wilcox$conf.int[1],
SanJVernalis_TP_flux_nov_wilcox$conf.int[1],
SanJVernalis_TP_flux_dec_wilcox$conf.int[1],
SanJVernalis_TP_flux_jan_wilcox$conf.int[1],
SanJVernalis_TP_flux_feb_wilcox$conf.int[1],
SanJVernalis_TP_flux_mar_wilcox$conf.int[1],
SanJVernalis_TP_flux_apr_wilcox$conf.int[1],
SanJVernalis_TP_flux_may_wilcox$conf.int[1],
SanJVernalis_TP_flux_jun_wilcox$conf.int[1],
SanJVernalis_TP_flux_jul_wilcox$conf.int[1],
SanJVernalis_TP_flux_aug_wilcox$conf.int[1],
SanJVernalis_TP_flux_sep_wilcox$conf.int[1]),
up_conf=c(SanJVernalis_TP_flux_oct_wilcox$conf.int[2],
SanJVernalis_TP_flux_nov_wilcox$conf.int[2],
SanJVernalis_TP_flux_dec_wilcox$conf.int[2],
SanJVernalis_TP_flux_jan_wilcox$conf.int[2],
SanJVernalis_TP_flux_feb_wilcox$conf.int[2],
SanJVernalis_TP_flux_mar_wilcox$conf.int[2],
SanJVernalis_TP_flux_apr_wilcox$conf.int[2],
SanJVernalis_TP_flux_may_wilcox$conf.int[2],
SanJVernalis_TP_flux_jun_wilcox$conf.int[2],
SanJVernalis_TP_flux_jul_wilcox$conf.int[2],
SanJVernalis_TP_flux_aug_wilcox$conf.int[2],
SanJVernalis_TP_flux_sep_wilcox$conf.int[2]))
write.table(Flux_compare, "SanJVernalis_TP_fluxwilcox.txt", quote=FALSE, row.names=FALSE)
rng_flx <- max(abs(c(Flux_compare$up_conf, Flux_compare$low_conf)))
tiff("SanJVernalis_TP_fluxshift_wilcox_Vert_Bars.tif", height=600, width=800, res=130)
par(mar=c(4,5,0.5,0.5))
plot(seq(1:12), Flux_compare$chng_est, typ='h', lend=1, lwd=15, col='white', xaxt='n', xlim=c(1,13), ylim=c(-rng_flx, rng_flx), xlab="Month", ylab=expression(paste("Median Flux Change, kg",sep='')), las=1)
plotCI(seq(1:12), Flux_compare$chng_est, ui=Flux_compare$up_conf, li=Flux_compare$low_conf, pch=16, add=TRUE)
abline(h=0)
axis(side=1,at=seq(1,12,by=1), labels=format(c(seq(as.Date("2000-10-01"), as.Date("2000-12-01"), by="month"), seq(as.Date("2000-01-01"), as.Date("2000-09-01"), by="month")),'%b'), las=2)
legend('topright', c("Median difference", "90% Confidence Interval for the Median"), pch=c(16,NA), lwd=c(NA,1), pt.cex=c(1,NA), pt.bg=c('black',NA), bty='n', bg='white')
dev.off()
localDaily <- getDaily(eList)
# Will need to adjust the date range below based on each gages unique start/stop dates
early_decade <- subset(localDaily, localDaily$Date > as.Date('1971-10-01') & localDaily$Date < as.Date('1981-10-01'))
recent_decade <- subset(localDaily, localDaily$Date > as.Date('2009-07-01'))
early_decade_monthly_mn <- aggregate(ConcDay ~ MonthSeq, data = early_decade, 'mean')
recent_decade_monthly_mn <- aggregate(ConcDay ~ MonthSeq, data = recent_decade, 'mean')
# early_decade_monthly_mn$month <- format(seq(as.Date('1972-10-01'), as.Date('1982-09-30'), by='month'), '%b')
early_decade_monthly_mn$month <- rep(c(10:12,1:9), times=10)
early_decade_mon_mn <- aggregate(ConcDay ~ month, data = early_decade_monthly_mn, 'mean')
early_decade_mon_sd <- aggregate(ConcDay ~ month, data = early_decade_monthly_mn, 'sd')
early_decade_mon_mn <- early_decade_mon_mn[c(10:12,1:9),]
early_decade_mon_sd <- early_decade_mon_sd[c(10:12,1:9),]
recent_decade_monthly_mn$month <- rep(c(10:12,1:9), times=10)
recent_decade_mon_mn <- aggregate(ConcDay ~ month, data = recent_decade_monthly_mn, 'mean')
recent_decade_mon_sd <- aggregate(ConcDay ~ month, data = recent_decade_monthly_mn, 'sd')
recent_decade_mon_mn <- recent_decade_mon_mn[c(10:12,1:9),]
recent_decade_mon_sd <- recent_decade_mon_sd[c(10:12,1:9),]
mdat2 <- matrix(c(early_decade_mon_mn$ConcDay, recent_decade_mon_mn$ConcDay),
nrow=2,ncol = 12, byrow=TRUE,
dimnames = list(c("1972-1982", "2009-2019"),
c(format(seq(as.Date('1973-10-01'), as.Date('1974-09-01'), by='month'), '%b'))))
# Be sure to adjust the legend's first decade start and stop year correctly
mx <- max(c((early_decade_mon_mn$ConcDay + early_decade_mon_sd$ConcDay), (recent_decade_mon_mn$ConcDay + recent_decade_mon_sd$ConcDay)))
tiff("timing_shift_in_TP_conc_monthly_means.tif", height=800, width=900, res=130)
par(mar=c(3,5,2,1))
x <- barplot(mdat2, beside=TRUE, las=1, ylim=c(0,mx), col = c("lightblue", "mistyrose"))
abline(h=0)
arrows(x0=x[1,], y0=early_decade_mon_mn$ConcDay - early_decade_mon_sd$ConcDay, x1=x[1,], y1=early_decade_mon_mn$ConcDay + early_decade_mon_sd$ConcDay, angle=90, length=0.04, code=3)
arrows(x0=x[2,], y0=recent_decade_mon_mn$ConcDay - recent_decade_mon_sd$ConcDay, x1=x[2,], y1=recent_decade_mon_mn$ConcDay + recent_decade_mon_sd$ConcDay, angle=90, length=0.04, code=3)
mtext(side=2, expression(paste(TP,', mg ',L^-1,sep='')), line=3)
legend(x=25, y=0.9 * mx, c("1972-1982", "2009-2019"), pch=c(22,22), pt.cex=2, pt.bg=c("lightblue", "mistyrose"), bty='n', xpd=TRUE)
dev.off()
# Now attempting a Wilcox Test (aka Mann-Whitney-Wilcoxon Rank Sum test)
# ----------------------------------------------------------------------
early_jan <- subset(early_decade_monthly_mn, month==1)
recent_jan <- subset(recent_decade_monthly_mn, month==1)
SanJVernalis_TP_conc_jan_wilcox <- wilcox.test(recent_jan$ConcDay, early_jan$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_feb <- subset(early_decade_monthly_mn, month==2)
recent_feb <- subset(recent_decade_monthly_mn, month==2)
SanJVernalis_TP_conc_feb_wilcox <- wilcox.test(recent_feb$ConcDay, early_feb$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_mar <- subset(early_decade_monthly_mn, month==3)
recent_mar <- subset(recent_decade_monthly_mn, month==3)
SanJVernalis_TP_conc_mar_wilcox <- wilcox.test(recent_mar$ConcDay, early_mar$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_apr <- subset(early_decade_monthly_mn, month==4)
recent_apr <- subset(recent_decade_monthly_mn, month==4)
SanJVernalis_TP_conc_apr_wilcox <- wilcox.test(recent_apr$ConcDay, early_apr$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_may <- subset(early_decade_monthly_mn, month==5)
recent_may <- subset(recent_decade_monthly_mn, month==5)
SanJVernalis_TP_conc_may_wilcox <- wilcox.test(recent_may$ConcDay, early_may$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_jun <- subset(early_decade_monthly_mn, month==6)
recent_jun <- subset(recent_decade_monthly_mn, month==6)
SanJVernalis_TP_conc_jun_wilcox <- wilcox.test(recent_jun$ConcDay, early_jun$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_jul <- subset(early_decade_monthly_mn, month==7)
recent_jul <- subset(recent_decade_monthly_mn, month==7)
SanJVernalis_TP_conc_jul_wilcox <- wilcox.test(recent_jul$ConcDay, early_jul$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_aug <- subset(early_decade_monthly_mn, month==8)
recent_aug <- subset(recent_decade_monthly_mn, month==8)
SanJVernalis_TP_conc_aug_wilcox <- wilcox.test(recent_aug$ConcDay, early_aug$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_sep <- subset(early_decade_monthly_mn, month==9)
recent_sep <- subset(recent_decade_monthly_mn, month==9)
SanJVernalis_TP_conc_sep_wilcox <- wilcox.test(recent_sep$ConcDay, early_sep$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_oct <- subset(early_decade_monthly_mn, month==10)
recent_oct <- subset(recent_decade_monthly_mn, month==10)
SanJVernalis_TP_conc_oct_wilcox <- wilcox.test(recent_oct$ConcDay, early_oct$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_nov <- subset(early_decade_monthly_mn, month==11)
recent_nov <- subset(recent_decade_monthly_mn, month==11)
SanJVernalis_TP_conc_nov_wilcox <- wilcox.test(recent_nov$ConcDay, early_nov$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_dec <- subset(early_decade_monthly_mn, month==12)
recent_dec <- subset(recent_decade_monthly_mn, month==12)
SanJVernalis_TP_conc_dec_wilcox <- wilcox.test(recent_dec$ConcDay, early_dec$ConcDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
Conc_compare <- data.frame(chng_est=c(SanJVernalis_TP_conc_oct_wilcox$est,
SanJVernalis_TP_conc_nov_wilcox$est,
SanJVernalis_TP_conc_dec_wilcox$est,
SanJVernalis_TP_conc_jan_wilcox$est,
SanJVernalis_TP_conc_feb_wilcox$est,
SanJVernalis_TP_conc_mar_wilcox$est,
SanJVernalis_TP_conc_apr_wilcox$est,
SanJVernalis_TP_conc_may_wilcox$est,
SanJVernalis_TP_conc_jun_wilcox$est,
SanJVernalis_TP_conc_jul_wilcox$est,
SanJVernalis_TP_conc_aug_wilcox$est,
SanJVernalis_TP_conc_sep_wilcox$est),
low_conf=c(SanJVernalis_TP_conc_oct_wilcox$conf.int[1],
SanJVernalis_TP_conc_nov_wilcox$conf.int[1],
SanJVernalis_TP_conc_dec_wilcox$conf.int[1],
SanJVernalis_TP_conc_jan_wilcox$conf.int[1],
SanJVernalis_TP_conc_feb_wilcox$conf.int[1],
SanJVernalis_TP_conc_mar_wilcox$conf.int[1],
SanJVernalis_TP_conc_apr_wilcox$conf.int[1],
SanJVernalis_TP_conc_may_wilcox$conf.int[1],
SanJVernalis_TP_conc_jun_wilcox$conf.int[1],
SanJVernalis_TP_conc_jul_wilcox$conf.int[1],
SanJVernalis_TP_conc_aug_wilcox$conf.int[1],
SanJVernalis_TP_conc_sep_wilcox$conf.int[1]),
up_conf=c(SanJVernalis_TP_conc_oct_wilcox$conf.int[2],
SanJVernalis_TP_conc_nov_wilcox$conf.int[2],
SanJVernalis_TP_conc_dec_wilcox$conf.int[2],
SanJVernalis_TP_conc_jan_wilcox$conf.int[2],
SanJVernalis_TP_conc_feb_wilcox$conf.int[2],
SanJVernalis_TP_conc_mar_wilcox$conf.int[2],
SanJVernalis_TP_conc_apr_wilcox$conf.int[2],
SanJVernalis_TP_conc_may_wilcox$conf.int[2],
SanJVernalis_TP_conc_jun_wilcox$conf.int[2],
SanJVernalis_TP_conc_jul_wilcox$conf.int[2],
SanJVernalis_TP_conc_aug_wilcox$conf.int[2],
SanJVernalis_TP_conc_sep_wilcox$conf.int[2]))
write.table(Conc_compare, "SanJVernalis_TP_conc_wilcox.txt", quote=FALSE, row.names=FALSE)
rng <- max(abs(c(Conc_compare$up_conf, Conc_compare$low_conf)))
tiff("SanJVernalis_TP_conc_shift_wilcox_Vert_Bars.tif", height=600, width=800, res=130)
par(mar=c(4,5,0.5,0.5))
plot(seq(1:12), Conc_compare$chng_est, typ='h', lend=1, lwd=15, col='white', xaxt='n', xlim=c(1,13), ylim=c(-rng, rng), xlab="Month", ylab=expression(paste("Median Concentration Change, mg  ",L^-1,sep='')), las=1)
plotCI(seq(1:12), Conc_compare$chng_est, ui=Conc_compare$up_conf, li=Conc_compare$low_conf, pch=16, add=TRUE)
abline(h=0)
axis(side=1,at=seq(1,12,by=1), labels=format(c(seq(as.Date("2000-10-01"), as.Date("2000-12-01"), by="month"), seq(as.Date("2000-01-01"), as.Date("2000-09-01"), by="month")),'%b'), las=2)
legend('topright', c("Median difference", "90% Confidence Interval for the Median"), pch=c(16,NA), lwd=c(NA,1), pt.cex=c(1,NA), pt.bg=c('black',NA), bty='n', bg='white')
dev.off()
# Now do the load
# ---------------
early_decade_monthly_flx <- aggregate(FluxDay ~ MonthSeq, data = early_decade, 'sum')
recent_decade_monthly_flx <- aggregate(FluxDay ~ MonthSeq, data = recent_decade, 'sum')
# early_decade_monthly_mn$month <- format(seq(as.Date('1972-10-01'), as.Date('1982-09-30'), by='month'), '%b')
early_decade_monthly_flx$month <- rep(c(10:12,1:9), times=10)
early_decade_mon_mn_flx <- aggregate(FluxDay ~ month, data = early_decade_monthly_flx, 'mean')
early_decade_mon_sd_flx <- aggregate(FluxDay ~ month, data = early_decade_monthly_flx, 'sd')
early_decade_mon_mn_flx <- early_decade_mon_mn_flx[c(10:12,1:9),]
early_decade_mon_sd_flx <- early_decade_mon_sd_flx[c(10:12,1:9),]
recent_decade_monthly_flx$month <- rep(c(10:12,1:9), times=10)
recent_decade_mon_mn_flx <- aggregate(FluxDay ~ month, data = recent_decade_monthly_flx, 'mean')
recent_decade_mon_sd_flx <- aggregate(FluxDay ~ month, data = recent_decade_monthly_flx, 'sd')
recent_decade_mon_mn_flx <- recent_decade_mon_mn_flx[c(10:12,1:9),]
recent_decade_mon_sd_flx <- recent_decade_mon_sd_flx[c(10:12,1:9),]
mdat3 <- matrix(c(early_decade_mon_mn_flx$FluxDay, recent_decade_mon_mn_flx$FluxDay),
nrow=2,ncol = 12, byrow=TRUE,
dimnames = list(c("1990-2000", "2001-2011"),
c(format(seq(as.Date('1973-10-01'), as.Date('1974-09-01'), by='month'), '%b'))))
mx <- max(c((early_decade_mon_mn_flx$FluxDay + early_decade_mon_sd_flx$FluxDay), (recent_decade_mon_mn_flx$FluxDay + recent_decade_mon_sd_flx$FluxDay)))
tiff("timing_shift_in_TP_load_monthly_means.tif", height=800, width=900, res=130)
x <- barplot(mdat3, beside=TRUE, las=1, ylim=c(0,mx), col = c("lightblue", "mistyrose"))
abline(h=0)
arrows(x0=x[1,], y0=early_decade_mon_mn_flx$FluxDay - early_decade_mon_sd_flx$FluxDay, x1=x[1,], y1=early_decade_mon_mn_flx$FluxDay + early_decade_mon_sd_flx$FluxDay, angle=90, length=0.04, code=3)
arrows(x0=x[2,], y0=recent_decade_mon_mn_flx$FluxDay - recent_decade_mon_sd_flx$FluxDay, x1=x[2,], y1=recent_decade_mon_mn_flx$FluxDay + recent_decade_mon_sd_flx$FluxDay, angle=90, length=0.04, code=3)
mtext(side=2, expression(paste(TP,', kg ',month^-1,sep='')), line=2.5)
legend(x=30, y=0.9 * mx, c("1990-2000", "2001-2011"), pch=c(22,22), pt.cex=2, pt.bg=c("lightblue", "mistyrose"), bty='n', xpd=TRUE)
dev.off()
# Apply Wilcox.text to the monthly loads here...
early_jan_flx <- subset(early_decade_monthly_flx, month==1)
recent_jan_flx <- subset(recent_decade_monthly_flx, month==1)
SanJVernalis_TP_flux_jan_wilcox <- wilcox.test(recent_jan_flx$FluxDay, early_jan_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_feb_flx <- subset(early_decade_monthly_flx, month==2)
recent_feb_flx <- subset(recent_decade_monthly_flx, month==2)
SanJVernalis_TP_flux_feb_wilcox <- wilcox.test(recent_feb_flx$FluxDay, early_feb_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_mar_flx <- subset(early_decade_monthly_flx, month==3)
recent_mar_flx <- subset(recent_decade_monthly_flx, month==3)
SanJVernalis_TP_flux_mar_wilcox <- wilcox.test(recent_mar_flx$FluxDay, early_mar_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_apr_flx <- subset(early_decade_monthly_flx, month==4)
recent_apr_flx <- subset(recent_decade_monthly_flx, month==4)
SanJVernalis_TP_flux_apr_wilcox <- wilcox.test(recent_apr_flx$FluxDay, early_apr_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_may_flx <- subset(early_decade_monthly_flx, month==5)
recent_may_flx <- subset(recent_decade_monthly_flx, month==5)
SanJVernalis_TP_flux_may_wilcox <- wilcox.test(recent_may_flx$FluxDay, early_may_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_jun_flx <- subset(early_decade_monthly_flx, month==6)
recent_jun_flx <- subset(recent_decade_monthly_flx, month==6)
SanJVernalis_TP_flux_jun_wilcox <- wilcox.test(recent_jun_flx$FluxDay, early_jun_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_jul_flx <- subset(early_decade_monthly_flx, month==7)
recent_jul_flx <- subset(recent_decade_monthly_flx, month==7)
SanJVernalis_TP_flux_jul_wilcox <- wilcox.test(recent_jul_flx$FluxDay, early_jul_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_aug_flx <- subset(early_decade_monthly_flx, month==8)
recent_aug_flx <- subset(recent_decade_monthly_flx, month==8)
SanJVernalis_TP_flux_aug_wilcox <- wilcox.test(recent_aug_flx$FluxDay, early_aug_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_sep_flx <- subset(early_decade_monthly_flx, month==9)
recent_sep_flx <- subset(recent_decade_monthly_flx, month==9)
SanJVernalis_TP_flux_sep_wilcox <- wilcox.test(recent_sep_flx$FluxDay, early_sep_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_oct_flx <- subset(early_decade_monthly_flx, month==10)
recent_oct_flx <- subset(recent_decade_monthly_flx, month==10)
SanJVernalis_TP_flux_oct_wilcox <- wilcox.test(recent_oct_flx$FluxDay, early_oct_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_nov_flx <- subset(early_decade_monthly_flx, month==11)
recent_nov_flx <- subset(recent_decade_monthly_flx, month==11)
SanJVernalis_TP_flux_nov_wilcox <- wilcox.test(recent_nov_flx$FluxDay, early_nov_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
early_dec_flx <- subset(early_decade_monthly_flx, month==12)
recent_dec_flx <- subset(recent_decade_monthly_flx, month==12)
SanJVernalis_TP_flux_dec_wilcox <- wilcox.test(recent_dec_flx$FluxDay, early_dec_flx$FluxDay, exact=TRUE, conf.int = TRUE, conf.level = 0.9)
Flux_compare <- data.frame(chng_est=c(SanJVernalis_TP_flux_oct_wilcox$est,
SanJVernalis_TP_flux_nov_wilcox$est,
SanJVernalis_TP_flux_dec_wilcox$est,
SanJVernalis_TP_flux_jan_wilcox$est,
SanJVernalis_TP_flux_feb_wilcox$est,
SanJVernalis_TP_flux_mar_wilcox$est,
SanJVernalis_TP_flux_apr_wilcox$est,
SanJVernalis_TP_flux_may_wilcox$est,
SanJVernalis_TP_flux_jun_wilcox$est,
SanJVernalis_TP_flux_jul_wilcox$est,
SanJVernalis_TP_flux_aug_wilcox$est,
SanJVernalis_TP_flux_sep_wilcox$est),
low_conf=c(SanJVernalis_TP_flux_oct_wilcox$conf.int[1],
SanJVernalis_TP_flux_nov_wilcox$conf.int[1],
SanJVernalis_TP_flux_dec_wilcox$conf.int[1],
SanJVernalis_TP_flux_jan_wilcox$conf.int[1],
SanJVernalis_TP_flux_feb_wilcox$conf.int[1],
SanJVernalis_TP_flux_mar_wilcox$conf.int[1],
SanJVernalis_TP_flux_apr_wilcox$conf.int[1],
SanJVernalis_TP_flux_may_wilcox$conf.int[1],
SanJVernalis_TP_flux_jun_wilcox$conf.int[1],
SanJVernalis_TP_flux_jul_wilcox$conf.int[1],
SanJVernalis_TP_flux_aug_wilcox$conf.int[1],
SanJVernalis_TP_flux_sep_wilcox$conf.int[1]),
up_conf=c(SanJVernalis_TP_flux_oct_wilcox$conf.int[2],
SanJVernalis_TP_flux_nov_wilcox$conf.int[2],
SanJVernalis_TP_flux_dec_wilcox$conf.int[2],
SanJVernalis_TP_flux_jan_wilcox$conf.int[2],
SanJVernalis_TP_flux_feb_wilcox$conf.int[2],
SanJVernalis_TP_flux_mar_wilcox$conf.int[2],
SanJVernalis_TP_flux_apr_wilcox$conf.int[2],
SanJVernalis_TP_flux_may_wilcox$conf.int[2],
SanJVernalis_TP_flux_jun_wilcox$conf.int[2],
SanJVernalis_TP_flux_jul_wilcox$conf.int[2],
SanJVernalis_TP_flux_aug_wilcox$conf.int[2],
SanJVernalis_TP_flux_sep_wilcox$conf.int[2]))
write.table(Flux_compare, "SanJVernalis_TP_fluxwilcox.txt", quote=FALSE, row.names=FALSE)
rng_flx <- max(abs(c(Flux_compare$up_conf, Flux_compare$low_conf)))
tiff("SanJVernalis_TP_fluxshift_wilcox_Vert_Bars.tif", height=600, width=800, res=130)
par(mar=c(4,5,0.5,0.5))
plot(seq(1:12), Flux_compare$chng_est, typ='h', lend=1, lwd=15, col='white', xaxt='n', xlim=c(1,13), ylim=c(-rng_flx, rng_flx), xlab="Month", ylab=expression(paste("Median Flux Change, kg",sep='')), las=1)
plotCI(seq(1:12), Flux_compare$chng_est, ui=Flux_compare$up_conf, li=Flux_compare$low_conf, pch=16, add=TRUE)
abline(h=0)
axis(side=1,at=seq(1,12,by=1), labels=format(c(seq(as.Date("2000-10-01"), as.Date("2000-12-01"), by="month"), seq(as.Date("2000-01-01"), as.Date("2000-09-01"), by="month")),'%b'), las=2)
legend('topright', c("Median difference", "90% Confidence Interval for the Median"), pch=c(16,NA), lwd=c(NA,1), pt.cex=c(1,NA), pt.bg=c('black',NA), bty='n', bg='white')
dev.off()
# End of non-standard EGRET plot section requested by Michael
# --------------------------------------------------------------------------------------------------------
#################  Using the plotConcQSmooth function
###########
#First do flow duration analysis
flowDuration(eList, centerDate = "06-01", qUnit = 2, span = 30)
date1 <- "1971-06-01"
date2 <- "1981-06-01"
date3 <- "1991-06-01"
date4 <- "2001-06-01"
date5 <- "2011-06-01"
qLow= baseQ
qHigh=highQ7
tiff("_Date_Discharge_TP_conc_no_log.tif",height = 700, width = 1000, res=120)
plotConcQSmooth(eList,date1, date2, date3,qLow, qHigh, logScale=FALSE,printLegend =TRUE,legendLeft=0,legendTop=0,printTitle=TRUE)
dev.off()
tiff("_Date1_Discharge_TP_conc_no_log.tif",height = 700, width = 1000, res=120)
plotConcQSmooth(eList,date1, date2, date3,qLow, qHigh, logScale=FALSE,printLegend =TRUE,legendLeft=0,legendTop=0,printTitle=TRUE)
dev.off()
tiff("_Date2_Discharge_TP_conc_no_log.tif",height = 700, width = 1000, res=120)
plotConcQSmooth(eList,date3, date4, date5,qLow, qHigh, logScale=FALSE,printLegend =TRUE,legendLeft=0,legendTop=0,printTitle=TRUE)
dev.off()
